# Цель состоит в том, чтобы реализовать простой генетический алгоритм для нахождения аппроксимации функции
________________________________________________________________________________________________________________________
# def genetic_algorithm(x, y, population_size, polynomial_order, generations, base_mutation_rate, err):
Функция genetic_algorithm реализует генетический алгоритм для оптимизации 
коэффициентов полинома, который аппроксимирует заданный набор данных. 

Она включает основные этапы генетического алгоритма: инициализацию, 
оценку приспособленности, отбор, кроссовер и мутацию 
1) Инициализация начальной популяции
2) Основной цикл по поколениям. Этот цикл выполняется до достижения заданного количества поколений (generations), либо 
до нахождения решения, удовлетворяющего критерию остановки (err).
3) Оценка приспособленности. Вызывается функция gpu_fitness_evaluation, которая оценивает приспособленность (качество) 
каждого индивида в популяции.
4) Проверка критерия остановки.
5) Динамическая настройка вероятности мутации.
6) Лучший индивид из текущего поколения автоматически переносится в следующее поколение.
7) Для создания нового индивида два родителя выбираются с использованием турнирного отбора.
8) Кроссовер (рекомбинация). Функция crossover выполняет обмен генетической информацией между родителями.
9) Амплитуда мутации (mutation_range) уменьшается со временем, чтобы стабилизировать решения в финальных поколениях.
10) Новый ребенок добавляется в новую популяцию.
11) Новая популяция заменяет старую, и процесс повторяется.
12) Возврат результата после всех поколений
________________________________________________________________________________________________________________________
# def gpu_fitness_evaluation(population, x, y, polynomial_order):
Функция gpu_fitness_evaluation используется для вычисления значений функции приспособленности (ошибки аппроксимации) 
для каждого индивида популяции
1) Определение размеров данных и выделение памяти. Копирование данных на GPU.
2) Запуск CUDA-ядра. Внутри CUDA-ядра для каждого индивида вычисляется среднеквадратическая ошибка (MSE) 
между предсказанными значениями полинома и целевыми значениями.
3) Возвращает массив значений приспособленности, где каждое значение характеризует качество аппроксимации для 
одного набора коэффициентов.
______________________________________________________________
# def tournament_selection(fitness_scores, selection_size=5):
Эта функция реализует турнирный отбор — способ выбора индивидов для участия в скрещивании в генетическом алгоритме.
1) Используется random.sample для случайного выбора индексов selection_size индивидов из общего пула популяции 
(размером len(fitness_scores)).
2) Поиск наилучшего индивида. min выбирает индекс индивида с наименьшим значением приспособленности 
(наиболее приспособленного).
3) Функция возвращает индекс индивида, который лучше всего подходит для следующего поколения.
______________________________________________________________
# def crossover(parent1, parent2, crossover_rate=0.7):
Эта функция реализует операцию кроссовера — процесс "скрещивания" двух индивидов, чтобы создать потомка.
1) Создание маски для кроссовера. Сравнение каждого элемента с crossover_rate создает булеву маску (True для кроссовера, 
False для сохранения исходного гена).
2) Если в маске стоит True, ген берется от второго родителя parent2. Если False, ген берется от первого родителя parent1.
3) Возвращается новый массив (геном потомка), сформированный в результате операции кроссовера.
_____________________________________________
# def mutate(child, mutation_rate, mutation_range):
Эта функция выполняет мутацию потомка, изменяя его гены с определенной вероятностью.
1) Проверка вероятности мутации.
2) Изменение генов.
3) Возвращается обновленный массив (геном потомка), который может быть слегка изменен из-за мутации.

# Пример запуска:
GPU Time: 27.204004049301147 секунд

Original coefficients: [-59.33460003  -9.57341437  21.68984454  87.78282382  -7.76390704]

Found coefficients: [-58.97077474 -10.24438879  21.66306201  87.79432057  -7.76361867]

Fitness: 2.9679303333537335

Evaluated generations: 500